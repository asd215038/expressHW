<!DOCTYPE html>
<html>

<head>
  <title>Water</title>
  <meta charset="zh-Hans-TW">
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css">

</head>

<body>
<h1>水費</h1>

<form >
  <label for="date">日期</label>
  <input type="text" id="date" name="date"><br><br>
  <label for="value">水費</label>
  <input type="text" id="value" name="value"><br><br>
</form>

<input type="button" id="submitButton" value="提交">
<script>
  document.getElementById('submitButton').addEventListener('click', async (e) => {
    e.preventDefault();
    const date = document.getElementById('date').value;
    const value = document.getElementById('value').value;
    const res = await fetch('/api/insert', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({date, value})
    });
    const data = await res.text();
    document.getElementById('submitButton').innerText = data;
  });
</script>


<button id="showdata">顯示資料</button>
<table id="data">
  <tr>
    <th>日期</th>
    <th>價格</th>
  </tr>
</table>

<script>
  document.getElementById('showdata').addEventListener('click', async () => {
    const response = await fetch('/api/data');
    const data = await response.json();
    const table = document.getElementById('data');
    data.forEach((item) => {
      const row = document.createElement('tr');
      row.innerHTML = `
                <td>${item.date}</td>
                <td>${item.value}</td>
            `;
      table.appendChild(row);
    });
  });

</script>
</body>
</html>
